import requests
import json

user_id = '50297041-ad0d-456c-b206-51fc866a22b8'
api_key = 'eyJ0eXAiOiJKV1QiLCJub25jZSI6IjZMTWhVQzFMWmwtMFNmT2F0bld3U0VmSmliYVU0ZlExb0V2NEhrdG5YYlEiLCJhbGciOiJSUzI1NiIsIng1dCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyIsImtpZCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9mM2I2ZGIxNC1hODlkLTQ3MWEtYTViNy05NzQwY2I2YzAwNzUvIiwiaWF0IjoxNjIxNzAyODY2LCJuYmYiOjE2MjE3MDI4NjYsImV4cCI6MTYyMTcwNjc2NiwiYWNjdCI6MCwiYWNyIjoiMSIsImFjcnMiOlsidXJuOnVzZXI6cmVnaXN0ZXJzZWN1cml0eWluZm8iLCJ1cm46bWljcm9zb2Z0OnJlcTEiLCJ1cm46bWljcm9zb2Z0OnJlcTIiLCJ1cm46bWljcm9zb2Z0OnJlcTMiLCJjMSIsImMyIiwiYzMiLCJjNCIsImM1IiwiYzYiLCJjNyIsImM4IiwiYzkiLCJjMTAiLCJjMTEiLCJjMTIiLCJjMTMiLCJjMTQiLCJjMTUiLCJjMTYiLCJjMTciLCJjMTgiLCJjMTkiLCJjMjAiLCJjMjEiLCJjMjIiLCJjMjMiLCJjMjQiLCJjMjUiXSwiYWlvIjoiQVNRQTIvOFRBQUFBajU2REc4ajlUcjRmdXVVbnMxVFF5YzZuOUwvcDk0K3Qrb2M0WGFSNTlpbz0iLCJhbXIiOlsicHdkIl0sImFwcF9kaXNwbGF5bmFtZSI6IkdyYXBoIGV4cGxvcmVyIChvZmZpY2lhbCBzaXRlKSIsImFwcGlkIjoiZGU4YmM4YjUtZDlmOS00OGIxLWE4YWQtYjc0OGRhNzI1MDY0IiwiYXBwaWRhY3IiOiIwIiwiaWR0eXAiOiJ1c2VyIiwiaXBhZGRyIjoiMTQuMTM4Ljc3LjQ1IiwibmFtZSI6Iuq5gOyLnO2YhCIsIm9pZCI6IjUxZGJiYmY5LWMxMDgtNDUzOS1iZWYwLWVlNzBmMWYwODNmMCIsInBsYXRmIjoiNSIsInB1aWQiOiIxMDAzMjAwMTFDQUM2MkNCIiwicmgiOiIwLkFWUUFGTnUyODUyb0drZWx0NWRBeTJ3QWRiWElpOTc1MmJGSXFLMjNTTnB5VUdSVUFLRS4iLCJzY3AiOiJDYWxlbmRhcnMuUmVhZCBDYWxlbmRhcnMuUmVhZFdyaXRlIG9wZW5pZCBQcmVzZW5jZS5SZWFkIFByZXNlbmNlLlJlYWQuQWxsIHByb2ZpbGUgVXNlci5SZWFkIGVtYWlsIiwic3ViIjoicHVkZloySHIwTEZWMzZvUHBubWVQR0VlUnRBRGdoSUpJTm4wUTV4QWpxUSIsInRlbmFudF9yZWdpb25fc2NvcGUiOiJBUyIsInRpZCI6ImYzYjZkYjE0LWE4OWQtNDcxYS1hNWI3LTk3NDBjYjZjMDA3NSIsInVuaXF1ZV9uYW1lIjoia3NoNzA3MjZAbzM2NS5odWZzLmFjLmtyIiwidXBuIjoia3NoNzA3MjZAbzM2NS5odWZzLmFjLmtyIiwidXRpIjoibDJTbnRnYTI4a3VJVjFzbDBZTVlBQSIsInZlciI6IjEuMCIsIndpZHMiOlsiYjc5ZmJmNGQtM2VmOS00Njg5LTgxNDMtNzZiMTk0ZTg1NTA5Il0sInhtc19zdCI6eyJzdWIiOiJIYjBfWUVNQ3o3RGU3RkVvcVRCcjJNREhPODBjWFdxVjVzZ2hENC1IYW1FIn0sInhtc190Y2R0IjoxNDQxMTc0NjYzfQ.dBRtRwV_9YbfD16zqX2JGK_ij3Or4w-LjC2eLN8Qq3_cUhPLbUHOqRbqVwDSl2JS9AxIKiMplsjFu6lR34cs8QGBSOOqYvHQgbJJnAwnkxoVmOdnbud2aYVoR0HeJz6SRfOilQbACTWTSy5J91IZ2-yNwftuEoNuUl-aTVXiRBOXBzov80G7AnASdBnUOUTxA4ArN0aHklIK__rHpU7N-0V_x9_90xYVChopfG148NPW2I4d2-Rq1qKLYNmhTiz7MmzZqgETTIhZBvFYmf-a8RVpB5CBGytPkFETE90y7HL63y6GqtNJ7TaoYg3g1bqKU81ArFtK29dUxTPpFjzdXA'

request_url = f'https://graph.microsoft.com/beta/users/{user_id}/presence'

request_header = {
    'Authorization': f'Bearer {api_key}',
}

response = requests.get(request_url, headers=request_header).json()

user_status = response['availability']

print(json.dumps({'user_status': user_status}))
